function escapeURL(e){return String(e).replace(/[&<>\-'\/]/g,function(e){var t={"&":"%26","<":"%3C",">":"%3E","-":"\\-","'":"%60","\\":"%5C","[":"%5B","]":"%5D"};return t[e]})}function refreshPhonebook(){if($("article.phonebook").empty(),0!=arrStaff.length)for(var e=0;e<arrStaff.length;e++){var t=$("<div/>",{html:"<span>"+arrStaff[e].Name+"</span><span>"+arrStaff[e].CellPhone+"</span>"});$("article.phonebook").append(t)}}function enableFields(){$("#itin-main button, #itin-main input").removeClass("disabled"),$("#itin-splash button").removeClass("disabled")}function onQueryFailed(e,t){console.log("Request failed."+t.get_message()+"\n"+t.get_stackTrace())}function onQueryFailedJSON(e,t,o){null!=e.responseJSON?console.log(e.responseJSON.error.code+": "+e.responseJSON.error.message.value):console.log(e)}function getStaffPhones(){searchTerm='(JobTitle:"a*" JobTitle:"b*" JobTitle:"c*" JobTitle:"d*" JobTitle:"e*"JobTitle:"f*" JobTitle:"g*" JobTitle:"h*" JobTitle:"i*" JobTitle:"j*"JobTitle:"k*" JobTitle:"l*" JobTitle:"m*" JobTitle:"n*" JobTitle:"o*"JobTitle:"p*" JobTitle:"q*" JobTitle:"r*" JobTitle:"s*" JobTitle:"t*"JobTitle:"u*" JobTitle:"v*" JobTitle:"w*" JobTitle:"x*" JobTitle:"y*"JobTitle:"z*" JobTitle:"0*" JobTitle:"1*" JobTitle:"2*" JobTitle:"3*"JobTitle:"4*" JobTitle:"5*" JobTitle:"6*" JobTitle:"7*" JobTitle:"8*"JobTitle:"9*")',searchUrl=_spPageContextInfo.webAbsoluteUrl+"/_api/search/query?querytext='"+searchTerm+"'&sortlist='PreferredName:ascending'&selectproperties='PreferredName,WorkPhone,CellPhone,HomePhone'&sourceid='"+_LOCAL_PEOPLE_RESULT_ID+"'&rowlimit='100'",$.ajax({url:searchUrl,type:"GET",headers:{Accept:"application/json; odata=verbose"},success:onStaffPhoneJSON,error:onQueryFailedJSON})}function onStaffPhoneJSON(e){arrStaff=[];var t=e.d.query.PrimaryQueryResult.RelevantResults.Table.Rows.results;t.length>0?($.each(t,function(e,t){var o={Name:t.Cells.results[2].Value,WorkPhone:null!=t.Cells.results[3].Value?t.Cells.results[3].Value:"",CellPhone:null!=t.Cells.results[4].Value?t.Cells.results[4].Value:"",HomePhone:null!=t.Cells.results[5].Value?t.Cells.results[5].Value:""};arrStaff.push(o)}),refreshPhonebook()):$("article.phonebook").html("Can't find any staff in the directory.")}var _LOCAL_PEOPLE_RESULT_ID="B09A7990-05EA-4AF9-81EF-EDFAB16C4E31",arrStaff=[],context=new SP.ClientContext.get_current,web=context.get_web(),user=web.get_currentUser();$(document).ready(function(){$(window).resize(function(){}),context.load(user),context.executeQueryAsync(function(){console.log(user)},function(){alert("Connection Failed. Refresh the page and try again. :(")})});